# hostcfg.txt - run from build environment

# log onto the host linux instance
ssh USER@HOST_IP_ADDR 
  
# On first setup of the host machine 
mkdir xdk
mkdir xqiz.it
mkdir xqiz.it/lib
mkdir xqiz.it/platform

cd xqiz.it
echo '{"dName":"CN=xtc-platform.localhost.xqiz.it",
"cert-provider":"self",
"httpPort":8080,
"httpsPort":8090
}' > platform/cfg.json
  
# copy your latest build to HOST_IP_ADDR
# Build paths may be different but we should probably be opinionated  
scp -r ~/xtclang/xvm/xdk/build/install/xdk/* USER@HOST_IP_ADDR:~/xdk
scp -r ~/xtclang/platform/lib/* USER@HOST_IP_ADDR:~/xqiz.it/lib

# update the HOST_MACHINE ~/.bashrc
export XDK_HOME="/Users/USER/xdk" [where USER is the local account]

# maintained for when/if we use non-locally signed certs
# ensure that "openssl" and "keytool" are installed
# sudo apt install certbot

# start the paas from ~/ in debug mode
cd
xec -L xqiz.it/lib/ kernel.xqiz.it $password
# or in "production" mode
nohup xec -L xqiz.it/lib/ kernel.xqiz.it $password &> platform.out&USER
